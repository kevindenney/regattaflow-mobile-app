# Claude Skills UX Integration - Visual Guide

## User Journey with AI Coach

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REGATTAFLOW USER JOURNEY                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“± PRE-RACE PLANNING (1-3 days before)
   â”œâ”€â”€ User opens Race Details screen
   â”œâ”€â”€ ğŸ¤– AI Coach automatically appears
   â”œâ”€â”€ Skill: starting-line-mastery
   â””â”€â”€ Shows: Line bias analysis, start strategy, timing plan

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ Pre-Race Planning                  â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ Quick Take:                        â”‚
       â”‚ "Pin end favored by 7Â°. Start     â”‚
       â”‚  middle-left for strategic access  â”‚
       â”‚  to left shift."                   â”‚
       â”‚                                    â”‚
       â”‚ âœ“ Action Items:                    â”‚
       â”‚ 1. Enter starting area 3min before â”‚
       â”‚ 2. Set up 5 boat lengths from pin  â”‚
       â”‚ 3. Use port approach, tack 30sec   â”‚
       â”‚                                    â”‚
       â”‚ ğŸ“Š Key Numbers:                    â”‚
       â”‚ Line bias: 7Â° (pin favored)        â”‚
       â”‚ Fleet size: 45 boats               â”‚
       â”‚ Wind: Oscillating 8-12kt           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â° START SEQUENCE (10 min before - 0)
   â”œâ”€â”€ User on water, approaching line
   â”œâ”€â”€ ğŸ¤– AI Coach updates automatically
   â”œâ”€â”€ Skill: starting-line-mastery
   â””â”€â”€ Shows: Speed control, space defense, final approach

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ Starting Soon (5:23 to start)      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ "Hold position 2 lengths from line.â”‚
       â”‚  Luff jib first to slow, keep main â”‚
       â”‚  trimmed for weather helm control."â”‚
       â”‚                                    â”‚
       â”‚ Speed Control:                     â”‚
       â”‚ â€¢ 3min: Enter area, establish lane â”‚
       â”‚ â€¢ 1min: Accelerate to full speed   â”‚
       â”‚ â€¢ 30sec: Commit to final position  â”‚
       â”‚ â€¢ 10sec: Maximum acceleration      â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â›µ FIRST BEAT (0 - 15 min)
   â”œâ”€â”€ Race started, sailing upwind
   â”œâ”€â”€ ğŸ¤– AI Coach detects "first-beat" phase
   â”œâ”€â”€ Skill: upwind-strategic-positioning
   â””â”€â”€ Shows: Wind pattern, side selection, tacking strategy

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ First Beat                         â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ "Oscillating wind, 10Â° range.      â”‚
       â”‚  Tack on 5Â° headers. Favor middle  â”‚
       â”‚  60% of course."                   â”‚
       â”‚                                    â”‚
       â”‚ Tacking Strategy:                  â”‚
       â”‚ Starboard: 170-185Â° (avg 177Â°)     â”‚
       â”‚ Port: 260-275Â° (avg 267Â°)          â”‚
       â”‚                                    â”‚
       â”‚ IF starboard >185Â° â†’ TACK (headed) â”‚
       â”‚ IF port <260Â° â†’ TACK (headed)      â”‚
       â”‚                                    â”‚
       â”‚ Risk: MEDIUM - Stay in middle 60%  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ¯ WEATHER MARK (Approaching)
   â”œâ”€â”€ GPS detects: 50m from windward mark
   â”œâ”€â”€ ğŸ¤– AI Coach switches to mark-rounding-execution
   â””â”€â”€ Shows: Approach angle, inside/outside, layline

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ Weather Mark (4 lengths away)      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ "Approach on port layline. Tack to â”‚
       â”‚  starboard 2 lengths before mark.  â”‚
       â”‚  Wide entry, tight exit."          â”‚
       â”‚                                    â”‚
       â”‚ Inside Overlap: NO                 â”‚
       â”‚ Boats nearby: 3                    â”‚
       â”‚ Strategy: Outside, clean rounding  â”‚
       â”‚                                    â”‚
       â”‚ Entry width: 2 boat lengths        â”‚
       â”‚ Exit: <1 foot from mark            â”‚
       â”‚ Next: Set spinnaker during turn    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒŠ REACHING (After weather mark)
   â”œâ”€â”€ GPS detects: heading downwind
   â”œâ”€â”€ ğŸ¤– AI Coach switches to downwind-speed-and-position
   â””â”€â”€ Shows: Rhumb line, puff/lull tactics, jibing plan

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ Reaching                           â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ "Bear off in puffs, head up in     â”‚
       â”‚  lulls. Stay below rhumb line in   â”‚
       â”‚  pressure."                        â”‚
       â”‚                                    â”‚
       â”‚ VMG Strategy:                      â”‚
       â”‚ Puff: Bear off 10Â° below rhumb     â”‚
       â”‚ Lull: Head up 5Â° toward rhumb      â”‚
       â”‚ Never sail above rhumb line        â”‚
       â”‚                                    â”‚
       â”‚ Jibing Plan:                       â”‚
       â”‚ â€¢ One jibe at mid-leg              â”‚
       â”‚ â€¢ Approach mark on starboard jibe  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ FINISH (Final approach)
   â”œâ”€â”€ GPS detects: near finish line
   â”œâ”€â”€ ğŸ¤– AI Coach switches to mark-rounding-execution (finish tactics)
   â””â”€â”€ Shows: Favored end, approach angle

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ’¡ AI Race Coach                   â”‚
       â”‚ Finish Line                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ "RC end favored by 4Â°. Approach on â”‚
       â”‚  starboard tack for right-of-way." â”‚
       â”‚                                    â”‚
       â”‚ Finish Strategy:                   â”‚
       â”‚ â€¢ Sail to RC end                   â”‚
       â”‚ â€¢ Starboard approach               â”‚
       â”‚ â€¢ Cross at full speed              â”‚
       â”‚                                    â”‚
       â”‚ Estimated gain: 2-3 positions      â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration Points in RegattaFlow App

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    APP SCREEN INTEGRATION                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£  RACE ENTRY / PLANNING SCREEN
    app/(tabs)/races.tsx â†’ RaceDetailScreen

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Race: Spring Championship       â”‚
    â”‚ Date: May 15, 2025              â”‚
    â”‚ Course: Windward-Leeward        â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                  â”‚
    â”‚  [SmartRaceCoach Component]      â”‚  â† ADD HERE
    â”‚  Shows: Pre-race strategy        â”‚
    â”‚                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Strategy Notes:                  â”‚
    â”‚ [Auto-filled from AI advice]     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


2ï¸âƒ£  PRE-RACE PREPARATION SCREEN
    app/race/prepare/[id].tsx

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â˜° Race Preparation               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ ğŸ Start Strategy                â”‚  â† Quick Skill Buttons
    â”‚ â›µ Upwind Plan                    â”‚
    â”‚ ğŸŒŠ Downwind Plan                 â”‚
    â”‚ ğŸ¯ Mark Tactics                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                  â”‚
    â”‚  [SmartRaceCoach - Expanded]     â”‚  â† Main AI coach
    â”‚                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Course Map                       â”‚
    â”‚ Weather Forecast                 â”‚
    â”‚ Competitors                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


3ï¸âƒ£  LIVE RACE SCREEN
    app/race/live/[id].tsx

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                  â”‚
    â”‚                                  â”‚
    â”‚       [Race Map View]            â”‚
    â”‚                                  â”‚
    â”‚                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [SmartRaceCoach - Minimal]       â”‚  â† Floating bottom
    â”‚ ğŸ’¡ "Tack on 5Â° header"           â”‚     Or minimized FAB
    â”‚ [Tap to expand]                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


4ï¸âƒ£  RACE TIMER SCREEN
    app/(tabs)/race/timer.tsx

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        5:00 to Start             â”‚
    â”‚                                  â”‚
    â”‚     â± Countdown Timer            â”‚
    â”‚                                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [SmartRaceCoach - Start Focus]   â”‚  â† Start-specific
    â”‚ Speed control, timing, position  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


5ï¸âƒ£  POST-RACE DEBRIEF
    app/race/debrief/[id].tsx

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Race Results: 12th / 45          â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Splits by Leg:                   â”‚
    â”‚ Start: -3 positions              â”‚
    â”‚ Beat 1: +2 positions             â”‚
    â”‚ Run 1: -1 position               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ [AI Analysis]                    â”‚  â† Post-race AI
    â”‚ "Lost positions at start due to  â”‚
    â”‚  late entry. Strong upwind but   â”‚
    â”‚  missed pressure on run."        â”‚
    â”‚                                  â”‚
    â”‚ Recommendations:                 â”‚
    â”‚ â€¢ Practice start timing drills   â”‚
    â”‚ â€¢ Study downwind pressure        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   COMPONENT ARCHITECTURE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RaceScreen
â”œâ”€â”€ RaceDetails
â””â”€â”€ SmartRaceCoach â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Main Component
    â”œâ”€â”€ useRacePhaseDetection â†â”€â”€â”€â”€â”€â”€ Hook (auto-detect phase)
    â”œâ”€â”€ SkillManagementService â†â”€â”€â”€â”€â”€ Service (invoke skills)
    â”‚   â”œâ”€â”€ SKILL_REGISTRY
    â”‚   â”œâ”€â”€ PHASE_TO_SKILLS
    â”‚   â””â”€â”€ invokeSkillWithContext()
    â””â”€â”€ UI Components
        â”œâ”€â”€ Header (phase label, controls)
        â”œâ”€â”€ QuickSummary (collapsed view)
        â””â”€â”€ ExpandedView
            â”œâ”€â”€ PrimaryAdvice
            â”œâ”€â”€ ActionItems
            â”œâ”€â”€ KeyMetrics
            â””â”€â”€ ConfidenceBadge

LiveRaceScreen
â”œâ”€â”€ TacticalRaceMap
â””â”€â”€ SmartRaceCoach (minimal mode)
    â””â”€â”€ FloatingActionButton (when minimized)

PrepareScreen
â”œâ”€â”€ QuickSkillButtons â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Quick access
â”‚   â”œâ”€â”€ "Start Strategy"
â”‚   â”œâ”€â”€ "Upwind Plan"
â”‚   â”œâ”€â”€ "Downwind Plan"
â”‚   â””â”€â”€ "Mark Tactics"
â””â”€â”€ SmartRaceCoach (expanded)
```

---

## Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATA FLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Action / GPS Update
          â”‚
          â–¼
   Race Phase Detection
    (useRacePhaseDetection)
          â”‚
          â”œâ”€â”€ Time to start? â†’ pre-race / start-sequence
          â”œâ”€â”€ GPS position? â†’ detect leg (beat/reach/run)
          â””â”€â”€ Distance to mark? â†’ weather-mark / leeward-mark
          â”‚
          â–¼
   Skill Selection
    (PHASE_TO_SKILLS mapping)
          â”‚
          â”œâ”€â”€ pre-race â†’ starting-line-mastery
          â”œâ”€â”€ first-beat â†’ upwind-strategic-positioning
          â”œâ”€â”€ weather-mark â†’ mark-rounding-execution
          â””â”€â”€ ... etc
          â”‚
          â–¼
   Context Building
    (buildContext function)
          â”‚
          â”œâ”€â”€ Gather: GPS, wind data, fleet size, etc.
          â””â”€â”€ Format for skill-specific prompt
          â”‚
          â–¼
   Skill Invocation
    (Anthropic API call)
          â”‚
          â”œâ”€â”€ POST /v1/messages
          â”œâ”€â”€ Include: model, prompt, skill ID
          â””â”€â”€ Receive: AI-generated advice
          â”‚
          â–¼
   Response Parsing
    (parseAdvice function)
          â”‚
          â”œâ”€â”€ Extract: primary, details, actions, metrics
          â””â”€â”€ Structure into Advice object
          â”‚
          â–¼
   UI Update
    (useState, re-render)
          â”‚
          â”œâ”€â”€ Show advice in expanded view
          â”œâ”€â”€ Animate in
          â””â”€â”€ Enable user interaction
```

---

## Quick Integration Checklist

```
âœ… SETUP (15 minutes)
   â–¡ Add SKILL_IDS to SkillManagementService.ts
   â–¡ Add PHASE_TO_SKILL mapping
   â–¡ Copy SmartRaceCoach.tsx to components/coaching/
   â–¡ Copy useRacePhaseDetection.ts to hooks/

âœ… BASIC INTEGRATION (30 minutes)
   â–¡ Add SmartRaceCoach to RaceDetailScreen
   â–¡ Pass raceData props (startTime, course, marks)
   â–¡ Test in development mode
   â–¡ Verify API calls working

âœ… ADVANCED FEATURES (1-2 hours)
   â–¡ Add GPS position tracking
   â–¡ Implement auto phase detection
   â–¡ Add QuickSkillButtons component
   â–¡ Create GlanceableAdviceCard
   â–¡ Add to LiveRaceScreen with minimal mode

âœ… POLISH (1-2 hours)
   â–¡ Add loading states
   â–¡ Implement error handling
   â–¡ Add haptic feedback
   â–¡ Cache responses
   â–¡ Add analytics tracking
```

---

## Example: Minimum Viable Integration

```typescript
// app/race/[id].tsx

import { SmartRaceCoach } from '@/components/coaching/SmartRaceCoach';

export default function RaceDetailScreen({ route }) {
  const { raceId } = route.params;
  const [race, setRace] = useState(null);

  useEffect(() => {
    // Load race data
    loadRace(raceId).then(setRace);
  }, [raceId]);

  return (
    <ScrollView>
      {/* Existing race details */}
      <RaceHeader race={race} />
      <RaceCourse course={race?.course} />

      {/* ADD THIS - that's it! */}
      <View className="p-4">
        <SmartRaceCoach
          raceId={raceId}
          raceData={{
            startTime: race?.date_time,
            fleetSize: race?.fleet_size,
            course: race?.course,
            marks: race?.course?.marks,
          }}
        />
      </View>

      {/* Rest of screen */}
      <StrategyNotes race={race} />
    </ScrollView>
  );
}
```

**That's it!** The SmartRaceCoach component handles:
- âœ… Race phase detection
- âœ… Skill selection
- âœ… API invocation
- âœ… UI presentation
- âœ… User interaction

---

## Visual Design Patterns

### Minimal Mode (Live Racing)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ Tack on 5Â° header   â”‚ â† Floating card, bottom of screen
â”‚ [Tap to expand]        â”‚   Auto-dismiss after 30s
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Expanded Mode (Planning)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ AI Race Coach                â”‚
â”‚ Pre-Race Planning               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Quick Take:                     â”‚ â† Purple highlight box
â”‚ "Pin end favored by 7Â°..."      â”‚
â”‚                                 â”‚
â”‚ âœ“ Action Items:                 â”‚ â† Numbered list
â”‚ 1. Enter area 3min before       â”‚
â”‚ 2. Set up 5 lengths from pin    â”‚
â”‚                                 â”‚
â”‚ ğŸ“Š Key Numbers:                 â”‚ â† Metrics table
â”‚ Line bias: 7Â°                   â”‚
â”‚ Fleet: 45 boats                 â”‚
â”‚                                 â”‚
â”‚ [Refresh] [Dismiss]             â”‚ â† Action buttons
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dismissed State
```
    [ğŸ¤– Ask AI Coach] â† Purple pill button
```

---

## Performance Optimization

```
CACHING STRATEGY:
â”œâ”€â”€ Cache skill responses for 60 seconds
â”œâ”€â”€ Don't re-invoke on minor GPS changes
â”œâ”€â”€ Debounce phase changes (wait 3 seconds)
â””â”€â”€ Use local storage for offline fallback

API CALL LIMITS:
â”œâ”€â”€ Max 1 call per minute per skill
â”œâ”€â”€ Max 5 calls per race
â””â”€â”€ Show cached advice when limit hit

LOADING STATES:
â”œâ”€â”€ Show skeleton UI while loading
â”œâ”€â”€ Fallback to cached advice on error
â””â”€â”€ Display "AI Coach unavailable" gracefully
```

---

## Summary

Your RegattaFlow Playbook Tactics skills are now integrated into a **smart, context-aware AI coach** that:

1. ğŸ¯ **Detects race phase automatically** - knows when you're starting vs. upwind vs. rounding
2. ğŸ§  **Selects the right skill** - uses starting-line-mastery at start, upwind-tactical-combat on beats, etc.
3. ğŸ’¬ **Provides actionable advice** - specific angles, times, and tactics formatted for quick consumption
4. ğŸ“± **Works everywhere** - pre-race planning, live racing (minimal mode), post-race debrief
5. ğŸš€ **Easy to integrate** - drop in `<SmartRaceCoach />` component, it handles the rest!

Next step: Copy `SmartRaceCoach.tsx` into your app and add it to one screen to see it in action! ğŸ†
